<div id="app">
  <app-tool-bar id="tool-bar" [savingPossible]="autoSaver.canSave" [autoSaveRunning]="autoSaver.isAutoSaving"></app-tool-bar>
  <div id="main-container">
    <app-pages-preview id="page-viewer" [bookCom]="editorService.bookCom" [currentPage]="editorService.pageCom" [currentPageProgress]="editorService.pageEditingProgress"></app-pages-preview>
    <div id="content">
      <div id="content-loading-wrapper">
        <app-sheet-overlay
          [pcgts]="editorService.pageStateVal.pcgts"
          id="sheet-overlay"
          *ngIf="toolbarStateService.currentPrimaryView === PrimaryViews.Editor && !editorService.pageLoading">
        </app-sheet-overlay>
        <div class="preprocessing" *ngIf="toolbarStateService.currentPrimaryView === PrimaryViews.Preprocessing">
          <app-preprocessing *ngIf="!editorService.pcgts"></app-preprocessing>
        </div>
        <div *ngIf="editorService.errorMessage !== ''">
          An error occured:
          {{ editorService.errorMessage }}
        </div>
      </div>
      <div class="load-overlay svg-overlay" *ngIf="editorService.isLoading">
        <app-loader-icon class="load-icon"></app-loader-icon>
      </div>
    </div>
    <div id="property-widgets">
      <div class="property-widget" *ngIf="toolbarStateService.currentEditorTool === ET.Symbol && sheetOverlayComponent.symbolEditor">
        <app-note-property-widget
          [selectedSymbol]="sheetOverlayComponent.symbolEditor.selectedSymbol"
        ></app-note-property-widget>
      </div>
      <div *ngIf="toolbarStateService.currentEditorTool === ET.LayoutExtractConnectedComponents
        || toolbarStateService.currentEditorTool === ET.Layout
        || toolbarStateService.currentEditorTool === ET.LayoutLassoArea" class="property-widget">
        <app-layout-property-widget></app-layout-property-widget>
      </div>
      <div *ngIf="toolbarStateService.currentEditorTool === ET.Syllables"
           class="property-widget"
      >
        <app-syllable-property-widget
          [page]="editorService.pcgts.page"
          [syllable]="sheetOverlayComponent.syllableEditor.selectedSyllable"
          (syllableChanged)="viewChanges.request([sheetOverlayComponent.syllableEditor.selectedSyllableNeumeConnection.syllableConnector.connection.textRegion])"
          (syllableClicked)="sheetOverlayComponent.syllableEditor.onSyllablePropertyWidgetClick($event)"
        ></app-syllable-property-widget>
      </div>
      <div *ngIf="sheetOverlayComponent && sheetOverlayComponent.currentEditorTool"
        class="property-widget">
        <app-view-property-widget
          [(viewSettings)]="sheetOverlayComponent.currentEditorTool.viewSettings"
          (resetToDefault)="sheetOverlayComponent.currentEditorTool.resetToDefaultViewSettings()"
          ></app-view-property-widget>
      </div>
      <div class="property-widget">
        <!-- <app-debug-action-statistics></app-debug-action-statistics>-->
      </div>
    </div>
  </div>
  <app-debug></app-debug>
</div>
